server:
  # HTTP 监听地址。
  listen: "0.0.0.0:8080"
  # Alertmanager Webhook 路径。
  path: "/alert"
  read_timeout: 5s
  write_timeout: 10s
  idle_timeout: 60s
  max_body_bytes: 4194304

auth:
  # 可选的共享 token 鉴权。
  # 支持的请求头：
  # - Authorization: Bearer <token>
  # - X-Token: <token>
  token: ""

template:
  # 模板目录：加载目录下的 "*.tmpl"。
  # 留空则使用内置 default 模板。
  #
  # Docker 示例：
  #   dir: "/data/templates"
  #
  # 如果目录不存在（例如未挂载），会自动回退使用内置 default 模板。
  dir: ""

admin:
  enabled: false
  path_prefix: "/admin"
  basic_auth:
    username: "admin"
    password: "change-me"

reload:
  # 安全热加载（原子切换 + 失败回滚）。
  enabled: false
  interval: 2s

dingtalk:
  timeout: 5s
  robots:
    - name: "default"
      webhook: "https://oapi.dingtalk.com/robot/send?access_token=YOUR_ACCESS_TOKEN"
      # 如果机器人启用了“加签”，填写 secret（可选）。
      secret: ""
      # markdown / text
      msg_type: "markdown"
      # 钉钉 markdown.title
      # - 留空：默认使用 Alertmanager 的 summary。
      title: ""

  # channels + routes：
  # - channels: 发送目标（绑定机器人、模板、@ 规则）
  # - routes:   按 receiver/status/labels 匹配，决定使用哪些 channels
  channels:
    - name: "default" # 必须存在
      robots: ["default"]
      template: "default"
      mention:
        at_all: false
        at_mobiles: []
        at_user_ids: []
      mention_rules:
        - name: "critical->@all"
          when:
            labels:
              severity: ["critical"]
          mention:
            at_all: true

  # routes 允许为空（此时所有告警都走 default channel）。
  routes:
    - name: "by-receiver"
      when:
        receiver: ["ops-team"]
      channels: ["default"]
